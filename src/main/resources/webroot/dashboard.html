<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>VChat</title>
    <script type="text/javascript">
        var eb = new EventBus("/userInfo/");
        eb.onopen = function () {
            eb.registerHandler("chat.to.client.userInfo", function (err, msg) {
                var parsedData = msg.body;
                localStorage.setItem("tokenKey",parsedData.tokenKey);
                localStorage.setItem("tokenKeySecret",parsedData.tokenKeySecret);
                var signinWin = window.open(parsedData.authorizationUrl, "SignIn", "width=780,height=410,toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left=" + 500 + ",top=" + 500);
                signinWin.focus();
                return false;
            });
        };

        function getUserInfo() {
            var data = {tokenKey:localStorage.getItem("tokenKey"),tokenKeySecret:localStorage.getItem("tokenKeySecret")};
            eb.publish("chat.to.server.userInfo", data);
        }
        $(document).ready(function(){
            getUserInfo();
        })
    </script>
</head>
<body>

</body>
</html>